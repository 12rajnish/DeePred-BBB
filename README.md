# DeePred-BBB

**DeePred-BBB** is a deep Neural network-based model for prediction of blood brain barrier permeability of compounds using 
Simplified Molecular Input Line Entry System (SMILES) notation of Compounds.

## Contents

The files contained in this repository are as follows:
 * ``DeePred-BBB_Script.py``: main script to run predictions
 * ``smiles.smi``: user input structures (multiple)
 * ``DeePredmodel.h5``: DNN prediction model
 * ``data.csv``: training dataset
 * ``PaDEL``: folder with executable for feature calculation

## Requirements

* Python
* Numpy
* Pandas
* Keras
* Tensorflow
* Scikit-Learn

## Usage

In order to run BBB permeability predictions with **DeePred-BBB**, save input structures as SMILES in a single 
file (e.g. ``smiles.smi``). Remember to give a name or ID to each structure.
 
### Running commands using the makefile
1. Clone / download this repository and change directories into it

2. Edit the `smiles.smi` file or create any number of files with a `*.smi` extension in the root directory. Add each structure on newlines in the file, in the format `<structure in SMILES format> <label for structure>`

3. Run the command `make run`. This will both output the model's predictions to stdout and put it into an output file.

### Other Makefile commands

- `make venv`
  - Create the venv, if not already existent
- `make install`
  - Installs all python requirements inside a venv environment
  - Note: the `run` command will also use this venv. If running commands manually (not using the makefile), use `source .venv/bin/activate` to activate the venv, and `deactivate` to deactivate it
- `make reinit`
  - Recreates the original demo structure file, if no other `*.smi` files exist

### Running commands manually

1. Download this repository and ensure that all the files are present in the same folder when running the script.
2. Run ``DeePred-BBB_Script.py``. 
  ```bash
  python DeePred-BBB_Script.py <folder>
  ```
   If ``<folder>`` is not provided, the script runs in the current directory.
   A csv file (``DeePred-BBB_predictions.csv``) will be created in the folder where the script is run.
   A file containing the features generated by PaDEL will be also saved to disk (``PaDEL_features.csv``).
  
> **_NOTE:_** Remember to activate the corresponding conda environment before running the script, if applicable.

## Citation

If you use **DeepPred-BBB** in your publication, consider citing the [paper](https://doi.org/10.3389/fnins.2022.858126):
```
@ARTICLE{10.3389/fnins.2022.858126,
AUTHOR={Kumar, Rajnish and Sharma, Anju and Alexiou, Athanasios and Bilgrami, Anwar L. and Kamal, Mohammad Amjad and Ashraf, Ghulam Md},   
TITLE={DeePred-BBB: A Blood Brain Barrier Permeability Prediction Model With Improved Accuracy},      
JOURNAL={Frontiers in Neuroscience},      
VOLUME={16},           
YEAR={2022},     
URL={https://www.frontiersin.org/articles/10.3389/fnins.2022.858126},       
DOI={10.3389/fnins.2022.858126},      	
ISSN={1662-453X}
}
```


